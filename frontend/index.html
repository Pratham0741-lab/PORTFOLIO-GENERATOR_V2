<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Portfolio Designer | Adaptive Layouts</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;600&family=Space+Grotesk:wght@300;700&family=Playfair+Display:ital@0;1&family=JetBrains+Mono:wght@400;700&family=Outfit:wght@900&family=Cormorant+Garamond:ital,wght@1,300&family=Special+Elite&family=Righteous&family=DM+Sans:wght@400;700&family=VT323&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* --- CORE --- */
        :root {
            --bg: #111; --text: #fff; --accent: #fff;
            --font-head: 'Inter'; --font-body: 'Inter';
            --radius: 8px; --border: 1px solid rgba(255,255,255,0.1);
        }

        body { margin: 0; background: var(--bg); color: var(--text); font-family: var(--font-body); transition: background 0.8s ease; overflow-x: hidden; }
        
        /* --- LAYOUT CONTAINER --- */
        #portfolio-view {
            min-height: 100vh;
            padding: 3rem 5%;
            transition: all 0.5s ease;
        }
        
        /* Default Grid (Sidebar Right) */
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 4rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* --- 1. ðŸ‡¨ðŸ‡­ SWISS: Sidebar LEFT, Strict Grid, No Gaps --- */
        [data-theme="swiss"] { --bg: #f4f4f4; --text: #000; --accent: #f00; --font-head: 'Space Grotesk'; --radius: 0; --border: 1px solid #ccc; }
        [data-theme="swiss"] .dashboard {
            grid-template-columns: 250px 1fr; /* FLIP SIDEBAR TO LEFT */
            gap: 0; /* NO GAPS */
            border: 1px solid #000;
        }
        [data-theme="swiss"] .sidebar { order: -1; border-right: 1px solid #000; padding-right: 2rem; }
        [data-theme="swiss"] .card { background: #fff; border: 1px solid #eee; animation: slideInLeft 0.8s cubic-bezier(0.25, 1, 0.5, 1); }

        /* --- 2. ðŸš§ BRUTAL: Sidebar TOP, Giant Text, Chaos --- */
        [data-theme="brutal"] { --bg: #fff000; --text: #000; --accent: #000; --font-head: 'Outfit'; --radius: 0; --border: 4px solid #000; }
        [data-theme="brutal"] .dashboard {
            display: flex; flex-direction: column; /* STACK VERTICALLY */
        }
        [data-theme="brutal"] .sidebar { order: -1; border-bottom: 5px solid #000; padding-bottom: 2rem; margin-bottom: 2rem; }
        [data-theme="brutal"] .hero h1 { font-size: 6rem; letter-spacing: -4px; text-transform: uppercase; }
        [data-theme="brutal"] .card {
            box-shadow: 10px 10px 0 #000;
            background: #fff;
            transform: rotate(-1deg);
            animation: slam 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* --- 3. ðŸŒ¿ ETHEREAL: Centered Column, Floating --- */
        [data-theme="ethereal"] { --bg: #fdfbf7; --text: #555; --accent: #d4af37; --font-head: 'Cormorant Garamond'; --radius: 50px; --border: none; }
        [data-theme="ethereal"] .dashboard {
            grid-template-columns: 1fr; /* SINGLE COLUMN */
            max-width: 800px;
            text-align: center;
        }
        [data-theme="ethereal"] .sidebar { display: none; } /* HIDE SIDEBAR FOR CLEAN LOOK */
        [data-theme="ethereal"] .card {
            background: #fff;
            box-shadow: 0 20px 60px -20px rgba(0,0,0,0.1);
            animation: floatUp 1.5s ease-out;
        }

        /* --- 4. ðŸ’¾ CYBER: Terminal Window --- */
        [data-theme="cyber"] { --bg: #000; --text: #0f0; --accent: #0f0; --font-head: 'VT323'; --radius: 0; --border: 1px solid #0f0; }
        [data-theme="cyber"] #portfolio-view { padding: 0; height: 100vh; display: flex; align-items: center; justify-content: center; }
        [data-theme="cyber"] .dashboard {
            width: 95%; height: 90vh; overflow-y: auto;
            border: 2px solid #0f0; padding: 2rem;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
            background: repeating-linear-gradient(0deg, rgba(0,255,0,0.03) 0px, rgba(0,255,0,0.03) 1px, transparent 1px, transparent 2px);
        }
        [data-theme="cyber"] .card { border: 1px dashed #0f0; background: rgba(0, 20, 0, 0.8); }

        /* --- 5. ðŸŽ¨ BAUHAUS: Asymmetric Grid --- */
        [data-theme="bauhaus"] { --bg: #e5e5e5; --text: #111; --accent: #0044cc; --font-head: 'DM Sans'; --radius: 0; --border: 3px solid #111; }
        [data-theme="bauhaus"] .project-grid {
            display: grid;
            grid-template-columns: 2fr 1fr; /* ASYMMETRIC */
        }
        [data-theme="bauhaus"] .card:first-child { grid-row: span 2; background: #fff; border-left: 10px solid #d13429; }
        [data-theme="bauhaus"] .card:nth-child(2) { background: #111; color: #fff; }
        [data-theme="bauhaus"] .card:nth-child(3) { border-bottom: 10px solid #e4d82c; }

        /* --- 6. ðŸ“œ PAPER: Scattered/Rotated --- */
        [data-theme="paper"] { --bg: #f3e9d2; --text: #333; --accent: #a63737; --font-head: 'Special Elite'; --radius: 2px; --border: 1px dashed #555; }
        [data-theme="paper"] .card {
            background: #fffdf0;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        /* Rotations applied via JS later */
        
        /* --- 7. ðŸŒƒ MIDNIGHT: Glassmorphism --- */
        [data-theme="midnight"] { --bg: #0f0c29; --text: #fff; --accent: #00ffff; --font-head: 'Inter'; --radius: 16px; --border: 1px solid rgba(255,255,255,0.1); background: linear-gradient(135deg, #0f0c29, #302b63); }
        [data-theme="midnight"] .card { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); }

        /* --- 8. ðŸ’¿ Y2K: Windows 95 Style --- */
        [data-theme="y2k"] { --bg: #e0f7fa; --text: #006064; --accent: #ff007f; --font-head: 'Righteous'; --radius: 4px; --border: 2px solid #fff; background: linear-gradient(180deg, #e0f7fa, #fff); }
        [data-theme="y2k"] .card {
            border: 2px solid #fff; border-right-color: #999; border-bottom-color: #999;
            background: #e0e0e0; padding: 10px;
        }
        [data-theme="y2k"] .card h3 { background: linear-gradient(90deg, #000080, #1084d0); color: #fff; padding: 5px; margin: -10px -10px 10px -10px; font-size: 0.9rem; }

        /* --- 9. ðŸŒ³ BOTANICAL: Organic Flow --- */
        [data-theme="botanical"] { --bg: #1a2f1a; --text: #e8f5e9; --accent: #81c784; --font-head: 'Cormorant Garamond'; --radius: 20px 0 20px 0; --border: 1px solid #2e7d32; }
        [data-theme="botanical"] .dashboard { gap: 2rem; }
        [data-theme="botanical"] .card { background: rgba(0, 50, 0, 0.3); border-left: 4px solid var(--accent); }

        /* --- 10. âš« OBSIDIAN: Stealth --- */
        [data-theme="obsidian"] { --bg: #050505; --text: #aaa; --accent: #fff; --font-head: 'Inter'; --radius: 0; --border: 1px solid #222; }
        [data-theme="obsidian"] .sidebar { opacity: 0.3; transition: opacity 0.5s; }
        [data-theme="obsidian"] .sidebar:hover { opacity: 1; }

        /* --- COMMON UI --- */
        .hidden { display: none !important; }
        .center-stage { height: 100vh; display: flex; align-items: center; justify-content: center; background: #000; }
        .glass-card { width: 400px; padding: 2.5rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 16px; color: #fff; text-align: center; }
        
        .hero h1 { font-family: var(--font-head); font-size: 3.5rem; line-height: 1; margin-bottom: 1rem; }
        .project-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; }
        
        .article-list { display: flex; flex-direction: column; gap: 1rem; margin-top: 3rem; }
        .article-card { padding: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1); }
        
        .sidebar { display: flex; flex-direction: column; gap: 2rem; }
        .stat-box { padding: 1.5rem; border: var(--border); border-radius: var(--radius); background: rgba(255,255,255,0.02); }
        .bar-bg { height: 6px; background: rgba(255,255,255,0.1); border-radius: 10px; margin-top: 5px; overflow: hidden; }
        .bar-fill { height: 100%; background: var(--accent); width: 0%; transition: width 1s; }

        /* --- ANIMATIONS --- */
        @keyframes slam { 0% { transform: scale(3); opacity: 0; } 100% { transform: scale(1) rotate(-1deg); opacity: 1; } }
        @keyframes floatUp { 0% { transform: translateY(50px); opacity: 0; } 100% { transform: translateY(0); opacity: 1; } }
        @keyframes slideInLeft { 0% { transform: translateX(-100px); opacity: 0; } 100% { transform: translateX(0); opacity: 1; } }
        
        #loader { position: fixed; inset: 0; background: #000; color: #fff; z-index: 999; display: flex; align-items: center; justify-content: center; font-family: monospace; }
        .blink { animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0; } }

        /* CONTROLS */
        .controls { margin-top: 2rem; display: flex; flex-direction: column; gap: 1rem; text-align: left; }
        input[type=range] { width: 100%; cursor: pointer; accent-color: white; }
        #generate-btn { width: 100%; padding: 1rem; border: none; font-weight: bold; cursor: pointer; margin-top: 2rem; border-radius: 50px; background: white; color: black; font-family: 'Space Grotesk'; text-transform: uppercase; }
        @media (max-width: 900px) { .dashboard { grid-template-columns: 1fr !important; } }
    </style>
</head>
<body>

    <div id="loader" class="hidden"><span class="blink">LOADING IDENTITY MATRIX...</span></div>

    <main id="quiz-view" class="center-stage">
        <div class="glass-card">
            <h2 style="font-family: 'Outfit'; font-weight: 200; font-size: 2.5rem; margin-bottom: 0.5rem;">Design Your Soul.</h2>
            <div class="controls">
                <div><label>STRUCTURE</label><input type="range" id="structure" value="50"></div>
                <div><label>ENERGY</label><input type="range" id="energy" value="50"></div>
                <div><label>WARMTH</label><input type="range" id="warmth" value="50"></div>
            </div>
            <button id="generate-btn">Materialize <i data-lucide="zap"></i></button>
        </div>
    </main>

    <main id="portfolio-view" class="hidden">
        <div class="dashboard">
            <section class="content-col">
                <nav style="display:flex; justify-content:space-between; margin-bottom:3rem;">
                    <div style="font-weight:900; font-family:var(--font-head); font-size:1.2rem;">Portfolio Designer.</div>
                    <button onclick="location.reload()" style="background:none; border:none; color:inherit; cursor:pointer;"><i data-lucide="rotate-ccw"></i></button>
                </nav>

                <div class="hero">
                    <h1 id="tagline"></h1>
                    <p id="bio"></p>
                </div>

                <div class="project-grid" id="projects"></div>
                
                <div class="article-list" id="articles"></div>
            </section>

            <aside class="sidebar">
                <div class="stat-box">
                    <h4 style="margin:0 0 1rem 0; opacity:0.6; font-family:var(--font-head);">USER MANUAL</h4>
                    <p id="manual-text" style="font-size:0.9rem; line-height:1.5; font-style:italic;"></p>
                </div>
                <div class="stat-box">
                    <h4 style="margin:0 0 1rem 0; opacity:0.6; font-family:var(--font-head);">SYSTEM METRICS</h4>
                    <div id="stats-container"></div>
                </div>
            </aside>
        </div>
    </main>

    <script>
        const dom = {
            quiz: document.getElementById('quiz-view'),
            portfolio: document.getElementById('portfolio-view'),
            loader: document.getElementById('loader'),
            btn: document.getElementById('generate-btn'),
            tagline: document.getElementById('tagline'),
            bio: document.getElementById('bio'),
            manual: document.getElementById('manual-text'),
            stats: document.getElementById('stats-container'),
            projects: document.getElementById('projects'),
            articles: document.getElementById('articles')
        };

        lucide.createIcons();

        dom.btn.addEventListener('click', async () => {
            dom.loader.classList.remove('hidden');
            const data = {
                structure: document.getElementById('structure').value,
                energy: document.getElementById('energy').value,
                warmth: document.getElementById('warmth').value
            };

            try {
                const res = await fetch('http://127.0.0.1:5000/generate', {
                    method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data)
                });
                const result = await res.json();
                renderIdentity(result.archetype, result.content);
            } catch (e) {
                console.error(e);
                dom.loader.innerHTML = "CONNECTION ERROR: Check Python Console";
            }
        });

        function renderIdentity(archetype, content) {
            document.body.setAttribute('data-theme', archetype);
            setTimeout(() => {
                dom.loader.classList.add('hidden');
                dom.quiz.classList.add('hidden');
                dom.portfolio.classList.remove('hidden');

                dom.tagline.innerText = content.tagline;
                dom.bio.innerText = content.bio;
                dom.manual.innerText = content.manual;

                // Projects
                dom.projects.innerHTML = '';
                content.projects.forEach(p => {
                    const rot = archetype === 'paper' ? Math.random() * 4 - 2 : 0;
                    dom.projects.innerHTML += `
                        <div class="card" style="transform: rotate(${rot}deg)">
                            <h3>${p.title}</h3>
                            <p>${p.desc}</p>
                        </div>`;
                });

                // Articles
                dom.articles.innerHTML = '';
                if(content.articles) {
                    content.articles.forEach(a => {
                        dom.articles.innerHTML += `
                            <div class="article-card">
                                <div style="font-size:0.8rem; color:var(--accent); margin-bottom:5px">${a.date}</div>
                                <h4 style="margin:0 0 5px 0">${a.title}</h4>
                                <p style="margin:0; opacity:0.7; font-size:0.9rem">${a.content}</p>
                            </div>`;
                    });
                }

                // Stats
                dom.stats.innerHTML = '';
                content.stats.forEach(stat => {
                    dom.stats.innerHTML += `
                        <div style="margin-bottom:1rem">
                            <div style="display:flex; justify-content:space-between; font-size:0.8rem; margin-bottom:5px;">
                                <span>${stat.label}</span><span>${stat.value}%</span>
                            </div>
                            <div class="bar-bg"><div class="bar-fill" style="width:${stat.value}%"></div></div>
                        </div>`;
                });

                lucide.createIcons();
            }, 1000);
        }
    </script>
</body>
</html>